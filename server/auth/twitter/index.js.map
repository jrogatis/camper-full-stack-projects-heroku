{"version":3,"sources":["auth/twitter/index.js"],"names":["router","Router","urlRedirect","get","authenticate","failureRedirect","session","req","res","params","redirectTo","redirect","user","status","send","token","_id","role","cookie"],"mappings":"AAAA;;;;;;AAEA;;;;AACA;;;;AACA;;;;AAKA,IAAIA,SAAS,kBAAQC,MAAR,EAAb;AACA,IAAIC,WAAJ;AACAF,OACGG,GADH,CACO,GADP,EACY,mBAASC,YAAT,CAAsB,SAAtB,EAAiC;AACzCC,mBAAiB,SADwB;AAEzCC,WAAS;AAFgC,CAAjC,CADZ,EAKGH,GALH,CAKO,iBALP,EAK0B,UAACI,GAAD,EAAMC,GAAN,EAAc;AACpCN,gBAAcK,IAAIE,MAAJ,CAAWC,UAAzB;AACAF,MAAIG,QAAJ,CAAa,gBAAb;AACD,CARH,EASGR,GATH,CASO,WATP,EAUI,mBAASC,YAAT,CAAsB,SAAtB,EAAiC;AAC/BC,mBAAiB,SADc;AAE/BC,WAAS;AAFsB,CAAjC,CAVJ,EAaQ,UAACC,GAAD,EAAMC,GAAN,EAAc;AAChB,MAAG,CAACD,IAAIK,IAAR,EAAc;AACZ,WAAOJ,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,wDAArB,CAAP;AACD;AACD,MAAIC,QAAQ,qBAAUR,IAAIK,IAAJ,CAASI,GAAnB,EAAwBT,IAAIK,IAAJ,CAASK,IAAjC,CAAZ;AACAT,MAAIU,MAAJ,CAAW,OAAX,EAAoBH,KAApB;AACA,MAAGb,WAAH,EAAgB;AACdM,QAAIG,QAAJ,CAAaT,WAAb;AACD,GAFD,MAEO;AACLM,QAAIG,QAAJ,CAAa,GAAb;AACD;AACF,CAxBL;;kBA2BeX,M","file":"auth/twitter/index.js","sourcesContent":["'use strict';\n\nimport express from 'express';\nimport passport from 'passport';\nimport {\n  signToken\n}\nfrom '../auth.service';\n\nvar router = express.Router();\nvar urlRedirect;\nrouter\n  .get('/', passport.authenticate('twitter', {\n    failureRedirect: '/signup',\n    session: false\n  }))\n  .get('/nl/:redirectTo', (req, res) => {\n    urlRedirect = req.params.redirectTo;\n    res.redirect('/auth/twitter/');\n  })\n  .get('/callback',\n    passport.authenticate('twitter', {\n      failureRedirect: '/signup',\n      session: false\n    }), (req, res) => {\n      if(!req.user) {\n        return res.status(404).send('It looks like you aren\\'t logged in, please try again.');\n      }\n      var token = signToken(req.user._id, req.user.role);\n      res.cookie('token', token);\n      if(urlRedirect) {\n        res.redirect(urlRedirect);\n      } else {\n        res.redirect('/');\n      }\n    }\n  );\n\nexport default router;\n"],"sourceRoot":"/source/"}